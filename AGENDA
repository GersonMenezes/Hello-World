#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct tipo{
char nome[30];
int idade;
int cell;
};

struct tam{
int cont, x, n;
char auxname[20];
};

int *cont, *x, *n;
char *auxname;
void *pBuffer;
int menu();
void retira();
void lista();
void busca();
void adiciona();

int main(){

pBuffer = (void*) malloc(sizeof(struct tam));
    if(pBuffer != NULL) printf("Alocado com sucesso\n");
x = pBuffer;
n = x+1;
cont = n+1;
*n = 0;
*x = 1;

    while(*x != 0){
    *x = menu();
    }

printf("Valor de X=%d",*x);
free(pBuffer);
    if(pBuffer == NULL) {
            printf("\n\nMemoria limpada com sucesso");}

return 0;
}


int menu(){

    printf("Diga a opcao desejada: \n");
    printf("\n0 para sair\n1 Adicionar\n2 Retirar\n3 Listar\n4 Buscar\n");
    scanf("%d", &*(int*)x);

        switch (*x){
        case 0:
            return 0;
            break;
        case 1:
            adiciona();
            break;
        case 2:
            retira();
            break;
        case 3:
            lista();
            break;
        case 4:
            busca();
            break;
        default:
            printf("Nenhuma alternativa correta");
            return 1;
        }
    getchar();
}

void retira(){
    auxname =(char*) (pBuffer + (sizeof(struct tam)-(20*sizeof(char)));
    //auxname = sizeof(struct tam)-(20*sizeof(char));
    printf("Diga o nome que desejas tirar");
    scanf("%s", auxname);

        for(*cont=0; *cont<*n; *cont++){

        }
    }
void lista(){}
void busca(){}

void adiciona(){
    *n += 1;
    pBuffer =(void*) realloc(pBuffer, sizeof(struct tam) + (*n*sizeof(struct tipo)));
    struct tipo *pPessoa;

    pPessoa = (struct tipo*)(Buffer + sizeof(struct tam) + ((*n-1)*sizeof(struct tipo)));
    printf("Diga o nome: ");
    scanf("%s", pPessoa->nome);
    printf("Nome: %s\n-------------------------------------\n", pPessoa->nome);
    }
