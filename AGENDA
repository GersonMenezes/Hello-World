#include <stdio.h>
#include <stdlib.h>

struct tipo{
char nome[30];
int idade;
int cell;
};

int menu(int *x, void *pBuffer, int *n);
void retira();
void lista();
void busca();
void adiciona(void *pBuffer, int *n);

int main(){

void *pBuffer = (struct tipo*) malloc(2*sizeof(int));
    if(pBuffer != NULL) printf("Alocado com sucesso\n");
int *x = pBuffer, *n = pBuffer;
n += sizeof(int);
*n = 0;

    while(*x != 0){
    *x = menu(x, pBuffer, n);
    }

printf("Valor de X=%d",*x);
free(pBuffer);
    if(pBuffer == NULL) {
            printf("\n\nMemoria limpada com sucesso");}

return 0;
}


int menu(int *x, void *pBuffer, int *n){

    printf("Diga a opcao desejada: \n");
    printf("\n0 para sair\n1 Adicionar\n2 Retirar\n3 Listar\n4 Buscar\n-------------------------------------\n");
    scanf("%d", &*(int*)x);

        switch (*x){
        case 0:
            return 0;
            break;
        case 1:
            adiciona(pBuffer, n);
            break;
        case 2:
            retira();
            break;
        case 3:
            lista();
            break;
        case 4:
            busca();
            break;
        default:
            printf("Nenhuma alternativa correta");
            return 1;
        }
}

void retira(){}
void lista(){}
void busca(){}

void adiciona(void *pBuffer, int *n){
    *n += 1;
    pBuffer =(struct tipo*) realloc(pBuffer, 2*sizeof(int) + (*n*sizeof(struct tipo)));
    char *pPessoa = pBuffer;
    int *pPerson;

    pPessoa = (2*sizeof(int)) + (*n*sizeof(struct tipo));
    printf("Diga o nome: ");
    scanf("%s", &*pPessoa);
    printf("Nome: %c" *pPessoa);
    
    }

